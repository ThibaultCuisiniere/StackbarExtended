p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
multigrp_strat = TRUE,
lda_cutoff = 4,
taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
multigrp_strat = TRUE,
lda_cutoff = 4,
taxa_rank = 'ASV'
)
mm_lefse <- run_lefse(
ps_mice,
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
multigrp_strat = TRUE,
lda_cutoff = 4,
taxa_rank = 'Genus'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
ps_mice <- subset_samples(ps, group == 'post-fmt')
#filter only this group, present in at leat 10% of the sample (n = 54)
dim(sample_data(ps_mice))
dim(otu_table(ps_mice))
ps_mice <- filter_taxa(ps_mice, function(x){sum(x > 0) > 6}, prune = TRUE)
sample_sums(ps_mice)
dim(otu_table(ps_mice))
mm_lefse <- run_lefse(
ps_mice,
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
multigrp_strat = TRUE,
lda_cutoff = 4,
taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
wilcoxon_cutoff = 0.1,
group = "leak",
kw_cutoff = 0.1,
multigrp_strat = TRUE,
lda_cutoff = 4,
taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
wilcoxon_cutoff = 0.1,
group = "leak",
kw_cutoff = 0.1,
multigrp_strat = TRUE,
lda_cutoff = 2,
taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
wilcoxon_cutoff = 0.1,
group = "leak",
kw_cutoff = 0.1,
multigrp_strat = TRUE,
lda_cutoff = 2,
taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "TSS",
wilcoxon_cutoff = 0.1,
group = "leak",
kw_cutoff = 0.1,
multigrp_strat = TRUE,
lda_cutoff = 2,
taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
View(tax_table(ps_mice))
ps_mice <- subset_samples(ps, group == 'post-fmt')
#filter only this group, present in at leat 10% of the sample (n = 54)
dim(sample_data(ps_mice))
dim(otu_table(ps_mice))
ps_mice <- filter_taxa(ps_mice, function(x){sum(x > 0) > 6}, prune = TRUE)
sample_sums(ps_mice)
dim(otu_table(ps_mice))
head(sample_data(ps_mice))
View(tax_table(ps_mice))
# ps_mice <- tax_glom(ps_mice, "Species", NArm = F)
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.1,
group = "leak",
kw_cutoff = 0.1,
multigrp_strat = TRUE,
lda_cutoff = 2,
taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.1,
group = "leak",
kw_cutoff = 0.1,
multigrp_strat = TRUE,
lda_cutoff = 2,
# taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
multigrp_strat = TRUE,
lda_cutoff = 2,
# taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 2,
# taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 3,
# taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
marker_table(mm_lefse)
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 4,
# taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 2,
taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
ggsave(filename = paste0("Lefse_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
ggsave(filename = paste0("Lefse__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
plot_ef_bar(mm_lefse)
plot_ef_dot(mm_lefse)
pc <- plot_cladogram(mm_lefse, color = c(no_leak = "darkgreen", leak = "red")) +
theme(plot.margin = margin(0, 0, 0, 0))
pc <- plot_cladogram(mm_lefse, color = c(no_leak = "darkgreen", leak = "red")) +
theme(plot.margin = margin(0, 0, 0, 0))
ps_mice <- subset_samples(ps, group == 'post-fmt')
#filter only this group, present in at leat 10% of the sample (n = 54)
dim(sample_data(ps_mice))
dim(otu_table(ps_mice))
ps_mice <- filter_taxa(ps_mice, function(x){sum(x > 0) > 6}, prune = TRUE)
sample_sums(ps_mice)
dim(otu_table(ps_mice))
head(sample_data(ps_mice))
#View(tax_table(ps_mice))
# ps_mice <- tax_glom(ps_mice, "Species", NArm = F)
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 2,
taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
pc <- plot_cladogram(mm_lefse, color = c(no_leak = "darkgreen", leak = "red")) +
theme(plot.margin = margin(0, 0, 0, 0))
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 2,
#taxa_rank = 'Species'
)
pc <- plot_cladogram(mm_lefse, color = c(no_leak = "darkgreen", leak = "red")) +
theme(plot.margin = margin(0, 0, 0, 0))
pc
ggsave(filename = paste0("Cladogramm_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
ggsave(filename = paste0("Cladogramm__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
pc <- plot_cladogram(mm_lefse, color = c(no_leak = "darkgreen", leak = "red")) +
theme(plot.margin = margin(0, 0, 0, 0))
pc
ggsave(filename = paste0("Cladogramm_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 45, height = 40, units = "cm" )
ggsave(filename = paste0("Cladogramm__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 45, height = 40, units = "cm" )
minTotRelAbun = 5e-5
# normalize in relative abundance
ps_mice <- subset_samples(ps, group == 'post-fmt')
dim(sample_data(ps_mice))
dim(otu_table(ps_mice))
minTotRelAbun = 5e-5
x = taxa_sums(ps_mice)
x
keepTaxa = taxa_names(ps_mice)[which((x / sum(x)) > minTotRelAbun)]
keepTaxa
prunedSet = prune_taxa(keepTaxa, ps_mice)
prunedSet
ps_mice <- prunedSet
sample_sums(ps_mice)
dim(otu_table(ps_mice))
head(sample_data(ps_mice))
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 2,
#taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 4,
#taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
#transform = "log10",
wilcoxon_cutoff = 0.05,
group = "leak",
kw_cutoff = 0.05,
lda_cutoff = 4,
#taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
View(marker_table(mm_lefse))
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
#transform = "log10",
wilcoxon_cutoff = 0.06,
group = "leak",
kw_cutoff = 0.06,
lda_cutoff = 4,
#taxa_rank = 'Species'
)
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
#transform = "log10",
wilcoxon_cutoff = 0.06,
group = "leak",
kw_cutoff = 0.06,
lda_cutoff = 4,
#taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
ggsave(filename = paste0("Lefse_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
ggsave(filename = paste0("Lefse__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
# bar plot
plot_ef_bar(mm_lefse)
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
#transform = "log10",
wilcoxon_cutoff =1,
group = "leak",
kw_cutoff = 1,
lda_cutoff = 4,
#taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
ggsave(filename = paste0("Lefse_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
ggsave(filename = paste0("Lefse__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
# bar plot
plot_ef_bar(mm_lefse)
plot_ef_dot(mm_lefse)
ggsave(filename = paste0("LDA_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
ggsave(filename = paste0("LDA__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
pc <- plot_cladogram(mm_lefse, color = c(no_leak = "darkgreen", leak = "red")) +
theme(plot.margin = margin(0, 0, 0, 0))
pc
ggsave(filename = paste0("Cladogramm_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 45, height = 40, units = "cm" )
ggsave(filename = paste0("Cladogramm__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 45, height = 40, units = "cm" )
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
#transform = "log10",
wilcoxon_cutoff =1,
group = "leak",
kw_cutoff = 1,
lda_cutoff = 4,
taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
ggsave(filename = paste0("Lefse_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
ggsave(filename = paste0("Lefse__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
plot_ef_bar(mm_lefse)
plot_ef_dot(mm_lefse)
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
transform = "log10",
wilcoxon_cutoff =1,
group = "leak",
kw_cutoff = 1,
lda_cutoff = 4,
taxa_rank = 'Species'
)
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
# transform = "log10",
wilcoxon_cutoff =1,
group = "leak",
kw_cutoff = 1,
lda_cutoff = 4,
taxa_rank = 'Species'
)
head(marker_table(mm_lefse))
View(marker_table(mm_lefse))
p_abd <- plot_abundance(mm_lefse, group = "leak")
p_abd
ggsave(filename = paste0("Lefse_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
ggsave(filename = paste0("Lefse__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
plot_ef_dot(mm_lefse)
ggsave(filename = paste0("LDA_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
ggsave(filename = paste0("LDA__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 25, height = 20, units = "cm" )
pc <- plot_cladogram(mm_lefse, color = c(no_leak = "darkgreen", leak = "red")) +
theme(plot.margin = margin(0, 0, 0, 0))
mm_lefse <- run_lefse(
ps_mice,
norm = "CPM",
# transform = "log10",
wilcoxon_cutoff =1,
group = "leak",
kw_cutoff = 1,
lda_cutoff = 4,
#taxa_rank = 'Species'
)
pc <- plot_cladogram(mm_lefse, color = c(no_leak = "darkgreen", leak = "red")) +
theme(plot.margin = margin(0, 0, 0, 0))
pc
ggsave(filename = paste0("Cladogramm_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 45, height = 40, units = "cm" )
ggsave(filename = paste0("Cladogramm__ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 45, height = 40, units = "cm" )
(mm_lefse)
(mm_lefse)
plot_ef_dot(mm_lefse)
# bar plot
plot_ef_bar(mm_lefse)
View(sample_data(ps_mice))
mm_edger <- run_edger(
ps_mice,
group = "leak",
pvalue_cutoff = 0.1,
p_adjust = "fdr"
)
mm_edger
plot_ef_bar(mm_edger)
mm_edger <- run_edger(
ps_mice,
group = "leak",
pvalue_cutoff = 0.05,
p_adjust = "fdr"
)
mm_edger
#> microbiom
plot_ef_bar(mm_edger)
mm_edger
mm_edger <- run_edger(
ps_mice,
group = "leak",
pvalue_cutoff = 0.05,
p_adjust = "fdr"
)
mm_edger
#> microbiom
plot_ef_bar(mm_edger)
ggsave(filename = paste0("Log2FC_EdgeR_ALvs_NoAL_mice_post-fmt",".jpeg"), device = "jpeg", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 45, height = 40, units = "cm" )
ggsave(filename = paste0("Log2FC_EdgeR_ALvs_NoAL_mice_post-fmt_species",".tiff"), device = "tiff", path = "I:/Chercheurs/Santos_Manuela/Thibault/Experiments/fmt_effect/Analysis_output", width = 45, height = 40, units = "cm" )
getSequences(ps)[1:5]
ps
refseq(ps)
fwrite(refseq(ps))
head(as.data.frame(refseq(ps)))
seq <- as.data.frame(refseq(ps)))
seq <- as.data.frame(refseq(ps))
seq
Biostrings::DNAStringSet(taxa_names(ps))
taxa_names(ps)
Biostrings::DNAStringSet(taxa_names(ps))
dna <- Biostrings::DNAStringSet(taxa_names(ps))
library(Biostrings)
Biostrings::DNAStringSet(taxa_names(ps))
dna <- Biostrings::DNAStringSet(taxa_names(ps))
sample_data(ps)
taxa_names(ps)
as.data.frame(tax_table(ps))                                                                                                                                                                                                                                            x
as.data.frame(tax_table(ps))                                                                                                                                                                                                                                            x
as.data.frame(tax_table(ps))                                                                                                                                                                                                                                    x
as.data.frame(tax_table(ps))
seq
taxtable <- as.data.frame(tax_table(ps))
taxtable
seq
colnames(seq)
colnames(seq) <- "sequence"
colnames(seq)
taxtableref <-merge(taxtable,seq,by='row.names',all=TRUE)
taxtableref
write.csv(taxtableref, "tax_table_ref.csv")
setwd("I:/Chercheurs/Santos_Manuela/Thibault/Gut_Microbiota_analysis/R script/stackbar/package")
getwd()
library("devtools")
library(roxygen2)
setwd("I:/Chercheurs/Santos_Manuela/Thibault/Gut_Microbiota_analysis/R script/stackbar/package")
getwd()
create("StackbarExtended")
create("StackbarExtended")
setwd("StackbarExtended/")
getwd()
document()
setwd("C:/Users/p0103422/Documents/R/R_package")
getwd()
create("StackbarExtended")
setwd("StackbarExtended/")
getwd()
document()
getwd()
document()
